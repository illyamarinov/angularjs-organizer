const app = angular.module('Trello', ['ngAnimate', 'ngRoute', 'ngSanitize']);

app.config(['$routeProvider', '$locationProvider', '$provide', '$httpProvider', '$qProvider', 'CONSTANTS', 'EVENTS', function ($routeProvider, $locationProvider, $provide, $httpProvider, $qProvider, CONSTANTS, EVENTS) {

    // disable error on unhandled rejections
    //$qProvider.errorOnUnhandledRejections(false);

    $routeProvider.when('/', {
        templateUrl: 'scripts/pages/home/home.html',
        controller: 'homeController',
        controllerAs: 'hc'
    }).when('/board', {
        templateUrl: 'scripts/pages/board/board.html',
        controller: 'boardController',
        controllerAs: 'bc'
    }).when('/404', {
        templateUrl: 'scripts/pages/404/404.html'
    }).otherwise({
        redirectTo: '/404'
    });

    $locationProvider.html5Mode(false).hashPrefix('');

    // $provide.decorator('$locale', function ($delegate) {
    //   var value = $delegate.DATETIME_FORMATS;
    //
    //   value.SHORTDAY = ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"];
    //
    //   return $delegate;
    // });

    $httpProvider.interceptors.push(function ($q, eventBusService, EVENTS) {
        return {
            'request': function (config) {
                // eventBusService.publish(EVENTS.loaderShow);
                return config;
            },
            'response': function (response) {
                // eventBusService.publish(EVENTS.loaderHide);
                return response;
            },
            'responseError': function (rejection) {
                // eventBusService.publish(EVENTS.loaderHide);
                return $q.reject(rejection);
            }
        };
    });

    $httpProvider.defaults.transformResponse.push(function (data) {
        return data;
    });
}]);
'use strict';

app.controller('rootController', ['$scope', '$rootScope', '$q', '$location', 'eventBusService', 'CONSTANTS', 'EVENTS', function ($scope, $rootScope, $q, $location, eventBusService, CONSTANTS, EVENTS) {

    $scope.init = function () {};

    $scope.init();
}]);
app.service('dashboardService', ['$http', 'CONSTANTS', function ($http, CONSTANTS) {
  return {
    getDashboards: function () {
      return $http.get(CONSTANTS.API_URL + 'dashboards');
    },

    getDashboardbyId: function (id) {
      return $http.get(CONSTANTS.API_URL + 'dashboards/' + id);
    },

    createDashboard: function (data) {
      return $http.post(CONSTANTS.API_URL + 'dashboards', data);
    },

    deleteDashboard: function (id) {
      return $http.delete(CONSTANTS.API_URL + 'dashboards/' + id);
    }
  };
}]);
var constants = {
    API_URL: 'https://trello-api-by-angie.herokuapp.com/',
    PATH: ''
};

app.constant('CONSTANTS', constants);
'use strict';

var events = {

    // route
    routeChangeStart: '$routeChangeStart',

    // loaded
    loaderShow: 'loader.show',
    loaderHide: 'loader.hide'
};

app.constant('EVENTS', events);
'use strict';

app.factory('utils', [function () {
    return {
        findByField: function (array, value, field) {
            field = field || 'Id';
            if (array) {
                return array.filter(function (item) {
                    return item[field] === value;
                })[0];
            } else {
                return null;
            }
        },
        findAllByField: function (array, field, value) {
            field = field || 'Id';
            if (array) {
                return array.filter(function (item) {
                    return item[field] === value;
                });
            } else {
                return null;
            }
        },
        makeFlat: function (object) {
            var newObject = {};
            if (!object) return {};

            Object.keys(object).map(function (key) {
                if (!angular.isObject(object[key]) || angular.isDate(object[key])) {
                    newObject[key] = object[key];
                } else {
                    newObject[key + "Id"] = object[key].Id;
                }
            });
            return newObject;
        }
    };
}]);
app.controller('cardController', function () {});
app.directive('card', function () {
  return {
    scope: {
      content: '='
    },
    restrict: 'E',
    templateUrl: 'scripts/components/card/card.html',
    controller: 'cardController',
    controllerAs: 'cc'
  };
});
app.controller('listController', function () {});
app.directive('list', function () {
  return {
    scope: {
      cards: '=',
      title: '=',
      addCard: '=',
      key: '@'
    },
    restrict: 'E',
    templateUrl: 'scripts/components/list/list.html',
    controller: 'listController',
    controllerAs: 'lc'
  };
});
app.controller('boardController', ['$scope', function ($scope) {

  $scope.lists = [{
    title: 'Need to do',
    items: [{ content: 'Learn Angular6' }]
  }, {
    title: 'Ready',
    items: [{ content: 'JavaScript' }]
  }, {
    title: 'In process',
    items: [{ content: 'Investigate AngularJS' }]
  }];

  this.addCard = function (index) {
    $scope.lists[index].items.push({ content: '' });
  };
}]);
app.controller('homeController', function ($scope, dashboardService) {

  $scope.getDashboards = dashboardService.getDashboards;
  $scope.createDashboard = dashboardService.createDashboard;
  $scope.deleteDashboard = dashboardService.deleteDashboard;

  $scope.getDashboards = function () {
    dashboardService.getDashboards().then(function success(response) {
      $scope.boards = response.data;
    }, function error(response) {
      $scope.boards = response.statusText;
    });
  };

  $scope.getDashboards();

  this.addBoard = function (data) {
    $scope.createDashboard(data);
    $scope.getDashboards();
  };

  this.deleteDashboard = function (id) {
    $scope.deleteDashboard(id);
    $scope.getDashboards();
  };
});
'use strict';

app.directive("contenteditable", function () {
    return {
        restrict: "A",
        require: "ngModel",
        link: function (scope, element, attrs, ngModel) {

            function read() {
                ngModel.$setViewValue(element.html());
            }

            ngModel.$render = function () {
                element.html(ngModel.$viewValue || "");
            };

            element.bind("blur keyup change", function () {
                scope.$apply(read);
            });
        }
    };
});
'use strict';

app.factory('eventBusService', function ($rootScope) {

    var msgBus = {};

    msgBus.publish = function (msg, data) {
        data = data || {};
        $rootScope.$broadcast(msg, data);
    };

    msgBus.subscribe = function (msg, scope, func) {
        return scope.$on(msg, func); // return for destroying listener
    };

    return msgBus;
});
"use strict";

app.filter('currencyNumberFilter', ['$locale', function ($locale) {

    return function (amount, divider) {
        if (angular.isUndefined(divider)) {
            divider = ' ';
        }

        if (amount === null) {
            return amount;
        }

        if (amount) {
            var parts = amount.toFixed(2).toString().split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, divider);

            return parts.join('.');
        } else {
            return '0.00';
        }
    };
}]);
'use strict';

/**
 * Example of use:
 * <input type="email" name="email2" ng-model="emailReg2" custom-validator="emailMatch" data-validate-function="checkEmailMatch(value)">
 * <span ng-show="registerForm.email2.$error.emailMatch">Emails have to match!</span>
 *
 * In controller:
 * $scope.checkEmailMatch=function(value) {
 *    return value===$scope.emailReg;
 * }
 */

app.directive('customValidator', [function () {
    return {
        restrict: 'A',
        require: 'ngModel',
        scope: {
            validateFunction: '&'
        },
        link: function (scope, elm, attr, ngModelCtrl) {
            ngModelCtrl.$parsers.push(function (value) {
                var result = scope.validateFunction({ 'value': value });
                if (result || result === false) {
                    if (result.then) {
                        result.then(function (data) {
                            // For promise type result object
                            ngModelCtrl.$setValidity(attr.customValidator, data);
                        }, function (error) {
                            ngModelCtrl.$setValidity(attr.customValidator, false);
                        });
                    } else {
                        ngModelCtrl.$setValidity(attr.customValidator, result);
                        return result ? value : undefined; // For boolean result return based on boolean value
                    }
                }
                return value;
            });
        }
    };
}]);
'use strict';

app.directive('noDirty', function () {
	return {
		require: 'ngModel',
		link: function (scope, element, attrs, ngModelCtrl) {
			// override the $setDirty method on ngModelController
			ngModelCtrl.$setDirty = angular.noop;
		}
	};
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInJvb3RDb250cm9sbGVyLmpzIiwic2VydmljZXMvZGFzaGJvYXJkU2VydmljZS5qcyIsInNoYXJlZC9jb25zdGFudHMuanMiLCJzaGFyZWQvZXZlbnRzLmpzIiwic2hhcmVkL3V0aWxzLmpzIiwiY29tcG9uZW50cy9jYXJkL2NhcmRDb250cm9sbGVyLmpzIiwiY29tcG9uZW50cy9jYXJkL2NhcmREaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2xpc3QvbGlzdENvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xpc3QvbGlzdERpcmVjdGl2ZS5qcyIsInBhZ2VzL2JvYXJkL2JvYXJkQ29udHJvbGxlci5qcyIsInBhZ2VzL2hvbWUvaG9tZUNvbnRyb2xsZXIuanMiLCJzaGFyZWQvZGlyZWN0aXZlcy9jb250ZW50ZWRpdGFibGUuanMiLCJzaGFyZWQvZXZlbnRCdXMvZXZlbnRCdXNTZXJ2aWNlLmpzIiwic2hhcmVkL2ZpbHRlcnMvY3VycmVuY3lOdW1iZXJGaWx0ZXIuanMiLCJzaGFyZWQvdmFsaWRhdGlvbi9jdXN0b21WYWxpZGF0b3JEaXJlY3RpdmUuanMiLCJzaGFyZWQvdmFsaWRhdGlvbi9ub0RpcnR5LmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJHByb3ZpZGUiLCIkaHR0cFByb3ZpZGVyIiwiJHFQcm92aWRlciIsIkNPTlNUQU5UUyIsIkVWRU5UUyIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaHRtbDVNb2RlIiwiaGFzaFByZWZpeCIsImludGVyY2VwdG9ycyIsInB1c2giLCIkcSIsImV2ZW50QnVzU2VydmljZSIsInJlc3BvbnNlIiwicmVqZWN0aW9uIiwicmVqZWN0IiwiZGVmYXVsdHMiLCJ0cmFuc2Zvcm1SZXNwb25zZSIsImRhdGEiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiJGxvY2F0aW9uIiwiaW5pdCIsInNlcnZpY2UiLCIkaHR0cCIsImdldERhc2hib2FyZHMiLCJnZXQiLCJBUElfVVJMIiwiZ2V0RGFzaGJvYXJkYnlJZCIsImlkIiwiY3JlYXRlRGFzaGJvYXJkIiwicG9zdCIsImRlbGV0ZURhc2hib2FyZCIsImRlbGV0ZSIsImNvbnN0YW50cyIsIlBBVEgiLCJjb25zdGFudCIsImV2ZW50cyIsInJvdXRlQ2hhbmdlU3RhcnQiLCJsb2FkZXJTaG93IiwibG9hZGVySGlkZSIsImZhY3RvcnkiLCJmaW5kQnlGaWVsZCIsImFycmF5IiwidmFsdWUiLCJmaWVsZCIsImZpbHRlciIsIml0ZW0iLCJmaW5kQWxsQnlGaWVsZCIsIm1ha2VGbGF0Iiwib2JqZWN0IiwibmV3T2JqZWN0IiwiT2JqZWN0Iiwia2V5cyIsIm1hcCIsImtleSIsImlzT2JqZWN0IiwiaXNEYXRlIiwiSWQiLCJkaXJlY3RpdmUiLCJzY29wZSIsImNvbnRlbnQiLCJyZXN0cmljdCIsImNhcmRzIiwidGl0bGUiLCJhZGRDYXJkIiwibGlzdHMiLCJpdGVtcyIsImluZGV4IiwiZGFzaGJvYXJkU2VydmljZSIsInRoZW4iLCJzdWNjZXNzIiwiYm9hcmRzIiwiZXJyb3IiLCJzdGF0dXNUZXh0IiwiYWRkQm9hcmQiLCJyZXF1aXJlIiwibGluayIsImVsZW1lbnQiLCJhdHRycyIsIm5nTW9kZWwiLCJyZWFkIiwiJHNldFZpZXdWYWx1ZSIsImh0bWwiLCIkcmVuZGVyIiwiJHZpZXdWYWx1ZSIsImJpbmQiLCIkYXBwbHkiLCJtc2dCdXMiLCJwdWJsaXNoIiwibXNnIiwiJGJyb2FkY2FzdCIsInN1YnNjcmliZSIsImZ1bmMiLCIkb24iLCIkbG9jYWxlIiwiYW1vdW50IiwiZGl2aWRlciIsImlzVW5kZWZpbmVkIiwicGFydHMiLCJ0b0ZpeGVkIiwidG9TdHJpbmciLCJzcGxpdCIsInJlcGxhY2UiLCJqb2luIiwidmFsaWRhdGVGdW5jdGlvbiIsImVsbSIsImF0dHIiLCJuZ01vZGVsQ3RybCIsIiRwYXJzZXJzIiwicmVzdWx0IiwiJHNldFZhbGlkaXR5IiwiY3VzdG9tVmFsaWRhdG9yIiwidW5kZWZpbmVkIiwiJHNldERpcnR5Iiwibm9vcCJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsTUFBTUMsUUFBUUMsTUFBUixDQUFlLFFBQWYsRUFBeUIsQ0FBQyxXQUFELEVBQWMsU0FBZCxFQUF5QixZQUF6QixDQUF6QixDQUFaOztBQUVBRixJQUFJRyxNQUFKLENBQVcsQ0FDUCxnQkFETyxFQUNXLG1CQURYLEVBQ2dDLFVBRGhDLEVBQzRDLGVBRDVDLEVBQzZELFlBRDdELEVBQzJFLFdBRDNFLEVBQ3dGLFFBRHhGLEVBRVAsVUFBVUMsY0FBVixFQUEwQkMsaUJBQTFCLEVBQTZDQyxRQUE3QyxFQUF1REMsYUFBdkQsRUFBc0VDLFVBQXRFLEVBQWtGQyxTQUFsRixFQUE2RkMsTUFBN0YsRUFBcUc7O0FBRWpHO0FBQ0E7O0FBRUFOLG1CQUNLTyxJQURMLENBQ1UsR0FEVixFQUNlO0FBQ1BDLHFCQUFhLDhCQUROO0FBRVBDLG9CQUFZLGdCQUZMO0FBR1BDLHNCQUFjO0FBSFAsS0FEZixFQU1LSCxJQU5MLENBTVUsUUFOVixFQU1vQjtBQUNaQyxxQkFBYSxnQ0FERDtBQUVaQyxvQkFBWSxpQkFGQTtBQUdaQyxzQkFBYztBQUhGLEtBTnBCLEVBV0tILElBWEwsQ0FXVSxNQVhWLEVBV2tCO0FBQ1ZDLHFCQUFhO0FBREgsS0FYbEIsRUFjS0csU0FkTCxDQWNlO0FBQ1BDLG9CQUFZO0FBREwsS0FkZjs7QUFrQkFYLHNCQUFrQlksU0FBbEIsQ0FBNEIsS0FBNUIsRUFBbUNDLFVBQW5DLENBQThDLEVBQTlDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBWCxrQkFBY1ksWUFBZCxDQUEyQkMsSUFBM0IsQ0FBZ0MsVUFBVUMsRUFBVixFQUFjQyxlQUFkLEVBQStCWixNQUEvQixFQUF1QztBQUNuRSxlQUFPO0FBQ0gsdUJBQVcsVUFBVVAsTUFBVixFQUFrQjtBQUN6QjtBQUNBLHVC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QUFaLEdBQXdCM0gsUUFBUTRILElBQWhDO0FBQ0E7QUFMSyxFQUFQO0FBT0EsQ0FSRCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYXBwID0gYW5ndWxhci5tb2R1bGUoJ1RyZWxsbycsIFsnbmdBbmltYXRlJywgJ25nUm91dGUnLCAnbmdTYW5pdGl6ZSddKTtcclxuXHJcbmFwcC5jb25maWcoW1xyXG4gICAgJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRwcm92aWRlJywgJyRodHRwUHJvdmlkZXInLCAnJHFQcm92aWRlcicsICdDT05TVEFOVFMnLCAnRVZFTlRTJyxcclxuICAgIGZ1bmN0aW9uICgkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICRwcm92aWRlLCAkaHR0cFByb3ZpZGVyLCAkcVByb3ZpZGVyLCBDT05TVEFOVFMsIEVWRU5UUykge1xyXG5cclxuICAgICAgICAvLyBkaXNhYmxlIGVycm9yIG9uIHVuaGFuZGxlZCByZWplY3Rpb25zXHJcbiAgICAgICAgLy8kcVByb3ZpZGVyLmVycm9yT25VbmhhbmRsZWRSZWplY3Rpb25zKGZhbHNlKTtcclxuXHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgLndoZW4oJy8nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvcGFnZXMvaG9tZS9ob21lLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2hvbWVDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2hjJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAud2hlbignL2JvYXJkJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL3BhZ2VzL2JvYXJkL2JvYXJkLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2JvYXJkQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdiYydcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLndoZW4oJy80MDQnLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvcGFnZXMvNDA0LzQwNC5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub3RoZXJ3aXNlKHtcclxuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvNDA0J1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKGZhbHNlKS5oYXNoUHJlZml4KCcnKTtcclxuXHJcbiAgICAgICAgLy8gJHByb3ZpZGUuZGVjb3JhdG9yKCckbG9jYWxlJywgZnVuY3Rpb24gKCRkZWxlZ2F0ZSkge1xyXG4gICAgICAgIC8vICAgdmFyIHZhbHVlID0gJGRlbGVnYXRlLkRBVEVUSU1FX0ZPUk1BVFM7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgIHZhbHVlLlNIT1JUREFZID0gW1wiU3VcIiwgXCJNb1wiLCBcIlR1XCIsIFwiV2VcIiwgXCJUaFwiLCBcIkZyXCIsIFwiU2FcIl07XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgIHJldHVybiAkZGVsZWdhdGU7XHJcbiAgICAgICAgLy8gfSk7XHJcblxyXG4gICAgICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goZnVuY3Rpb24gKCRxLCBldmVudEJ1c1NlcnZpY2UsIEVWRU5UUykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgJ3JlcXVlc3QnOiBmdW5jdGlvbiAoY29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZXZlbnRCdXNTZXJ2aWNlLnB1Ymxpc2goRVZFTlRTLmxvYWRlclNob3cpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25maWc7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgJ3Jlc3BvbnNlJzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZXZlbnRCdXNTZXJ2aWNlLnB1Ymxpc2goRVZFTlRTLmxvYWRlckhpZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAncmVzcG9uc2VFcnJvcic6IGZ1bmN0aW9uIChyZWplY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBldmVudEJ1c1NlcnZpY2UucHVibGlzaChFVkVOVFMubG9hZGVySGlkZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlLnB1c2goZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbl0pO1xyXG4iLCIndXNlIHN0cmljdCc7XG5cbmFwcC5jb250cm9sbGVyKCdyb290Q29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHEnLCAnJGxvY2F0aW9uJywgJ2V2ZW50QnVzU2VydmljZScsICdDT05TVEFOVFMnLCAnRVZFTlRTJyxcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCAkcSwgJGxvY2F0aW9uLCBldmVudEJ1c1NlcnZpY2UsIENPTlNUQU5UUywgRVZFTlRTKSB7XG5cbiAgICAgICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICAkc2NvcGUuaW5pdCgpO1xuXG4gICAgfVxuXSk7XG4iLCJhcHAuc2VydmljZSgnZGFzaGJvYXJkU2VydmljZScsIFsnJGh0dHAnLCAnQ09OU1RBTlRTJywgZnVuY3Rpb24oJGh0dHAsIENPTlNUQU5UUykge1xyXG4gIHJldHVybiB7XHJcbiAgICBnZXREYXNoYm9hcmRzOiBmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuICRodHRwLmdldChDT05TVEFOVFMuQVBJX1VSTCArICdkYXNoYm9hcmRzJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldERhc2hib2FyZGJ5SWQ6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoQ09OU1RBTlRTLkFQSV9VUkwgKyAnZGFzaGJvYXJkcy8nICsgaWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjcmVhdGVEYXNoYm9hcmQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgcmV0dXJuICRodHRwLnBvc3QoQ09OU1RBTlRTLkFQSV9VUkwgKyAnZGFzaGJvYXJkcycsIGRhdGEpO1xyXG4gICAgfSxcclxuXHJcbiAgICBkZWxldGVEYXNoYm9hcmQ6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoQ09OU1RBTlRTLkFQSV9VUkwgKyAnZGFzaGJvYXJkcy8nICsgaWQpO1xyXG4gICAgfVxyXG4gIH1cclxufV0pXHJcbiIsInZhciBjb25zdGFudHMgPSB7XG4gICAgQVBJX1VSTDogJ2h0dHBzOi8vdHJlbGxvLWFwaS1ieS1hbmdpZS5oZXJva3VhcHAuY29tLycsXG4gICAgUEFUSDogJycsXG59O1xuXG5hcHAuY29uc3RhbnQoJ0NPTlNUQU5UUycsIGNvbnN0YW50cyk7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBldmVudHMgPSB7XG5cbiAgICAvLyByb3V0ZVxuICAgIHJvdXRlQ2hhbmdlU3RhcnQ6ICckcm91dGVDaGFuZ2VTdGFydCcsXG5cbiAgICAvLyBsb2FkZWRcbiAgICBsb2FkZXJTaG93OiAnbG9hZGVyLnNob3cnLFxuICAgIGxvYWRlckhpZGU6ICdsb2FkZXIuaGlkZSdcbn07XG5cbmFwcC5jb25zdGFudCgnRVZFTlRTJywgZXZlbnRzKTsiLCIndXNlIHN0cmljdCc7XG5cbmFwcC5mYWN0b3J5KCd1dGlscycsIFtmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBmaW5kQnlGaWVsZDogZnVuY3Rpb24gKGFycmF5LCB2YWx1ZSwgZmllbGQpIHtcbiAgICAgICAgICAgIGZpZWxkID0gZmllbGQgfHwgJ0lkJztcbiAgICAgICAgICAgIGlmIChhcnJheSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheS5maWx0ZXIoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVtmaWVsZF0gPT09IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pWzBdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblx0ICAgIGZpbmRBbGxCeUZpZWxkOiBmdW5jdGlvbiAoYXJyYXksIGZpZWxkLCB2YWx1ZSkge1xuICAgICAgICAgICAgZmllbGQgPSBmaWVsZCB8fCAnSWQnO1xuICAgICAgICAgICAgaWYgKGFycmF5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5LmZpbHRlcihmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtW2ZpZWxkXSA9PT0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBtYWtlRmxhdDogZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICAgICAgdmFyIG5ld09iamVjdCA9IHt9O1xuXHQgICAgICAgIGlmICghb2JqZWN0KSByZXR1cm4ge307XG5cbiAgICAgICAgICAgIE9iamVjdC5rZXlzKG9iamVjdCkubWFwKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChvYmplY3Rba2V5XSkgfHwgYW5ndWxhci5pc0RhdGUob2JqZWN0W2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09iamVjdFtrZXldID0gb2JqZWN0W2tleV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T2JqZWN0W2tleSArIFwiSWRcIl0gPSBvYmplY3Rba2V5XS5JZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBuZXdPYmplY3Q7XG4gICAgICAgIH1cbiAgICB9O1xufV0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ2NhcmRDb250cm9sbGVyJywgZnVuY3Rpb24oKSB7XHJcbiAgXHJcbn0pO1xyXG4iLCJhcHAuZGlyZWN0aXZlKCdjYXJkJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHNjb3BlOiB7XHJcbiAgICAgIGNvbnRlbnQ6ICc9J1xyXG4gICAgfSxcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvY29tcG9uZW50cy9jYXJkL2NhcmQuaHRtbCcsXHJcbiAgICBjb250cm9sbGVyOiAnY2FyZENvbnRyb2xsZXInLFxyXG4gICAgY29udHJvbGxlckFzOiAnY2MnXHJcbiAgfVxyXG59KTtcclxuIiwiYXBwLmNvbnRyb2xsZXIoJ2xpc3RDb250cm9sbGVyJywgZnVuY3Rpb24oKSB7XHJcblxyXG59KTtcclxuIiwiYXBwLmRpcmVjdGl2ZSgnbGlzdCcsIGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICBzY29wZToge1xyXG4gICAgICBjYXJkczogJz0nLFxyXG4gICAgICB0aXRsZTogJz0nLFxyXG4gICAgICBhZGRDYXJkOiAnPScsXHJcbiAgICAgIGtleTogJ0AnXHJcbiAgICB9LFxyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9jb21wb25lbnRzL2xpc3QvbGlzdC5odG1sJyxcclxuICAgIGNvbnRyb2xsZXI6ICdsaXN0Q29udHJvbGxlcicsXHJcbiAgICBjb250cm9sbGVyQXM6ICdsYydcclxuICB9XHJcbn0pO1xyXG4iLCJhcHAuY29udHJvbGxlcignYm9hcmRDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuXHJcbiAgJHNjb3BlLmxpc3RzID0gW3tcclxuICAgIHRpdGxlOiAnTmVlZCB0byBkbycsXHJcbiAgICBpdGVtczogW3sgY29udGVudDogJ0xlYXJuIEFuZ3VsYXI2JyB9XVxyXG4gIH0sIHtcclxuICAgIHRpdGxlOiAnUmVhZHknLFxyXG4gICAgaXRlbXM6IFt7IGNvbnRlbnQ6ICdKYXZhU2NyaXB0JyB9XVxyXG4gIH0sIHtcclxuICAgIHRpdGxlOiAnSW4gcHJvY2VzcycsXHJcbiAgICBpdGVtczogW3sgY29udGVudDogJ0ludmVzdGlnYXRlIEFuZ3VsYXJKUycgfV1cclxuICB9XTtcclxuXHJcbiAgdGhpcy5hZGRDYXJkID0gZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICRzY29wZS5saXN0c1tpbmRleF0uaXRlbXMucHVzaCh7IGNvbnRlbnQ6ICcnIH0pO1xyXG4gIH07XHJcblxyXG59XSk7XHJcbiIsImFwcC5jb250cm9sbGVyKCdob21lQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgZGFzaGJvYXJkU2VydmljZSkge1xyXG5cclxuICAkc2NvcGUuZ2V0RGFzaGJvYXJkcyA9IGRhc2hib2FyZFNlcnZpY2UuZ2V0RGFzaGJvYXJkcztcclxuICAkc2NvcGUuY3JlYXRlRGFzaGJvYXJkID0gZGFzaGJvYXJkU2VydmljZS5jcmVhdGVEYXNoYm9hcmQ7XHJcbiAgJHNjb3BlLmRlbGV0ZURhc2hib2FyZCA9IGRhc2hib2FyZFNlcnZpY2UuZGVsZXRlRGFzaGJvYXJkO1xyXG5cclxuICAkc2NvcGUuZ2V0RGFzaGJvYXJkcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgZGFzaGJvYXJkU2VydmljZS5nZXREYXNoYm9hcmRzKCkudGhlbihmdW5jdGlvbiBzdWNjZXNzKHJlc3BvbnNlKSB7XHJcbiAgICAgICRzY29wZS5ib2FyZHMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgfSwgZnVuY3Rpb24gZXJyb3IocmVzcG9uc2UpIHtcclxuICAgICAgJHNjb3BlLmJvYXJkcyA9IHJlc3BvbnNlLnN0YXR1c1RleHQ7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICAkc2NvcGUuZ2V0RGFzaGJvYXJkcygpO1xyXG5cclxuICB0aGlzLmFkZEJvYXJkID0gZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgJHNjb3BlLmNyZWF0ZURhc2hib2FyZChkYXRhKTtcclxuICAgICRzY29wZS5nZXREYXNoYm9hcmRzKCk7XHJcbiAgfTtcclxuXHJcbiAgdGhpcy5kZWxldGVEYXNoYm9hcmQgPSBmdW5jdGlvbihpZCkge1xyXG4gICAgJHNjb3BlLmRlbGV0ZURhc2hib2FyZChpZCk7XHJcbiAgICAkc2NvcGUuZ2V0RGFzaGJvYXJkcygpO1xyXG4gIH1cclxufSk7XHJcbiIsIid1c2Ugc3RyaWN0JztcblxuYXBwLmRpcmVjdGl2ZShcImNvbnRlbnRlZGl0YWJsZVwiLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJBXCIsXG4gICAgICAgIHJlcXVpcmU6IFwibmdNb2RlbFwiLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVhZCgpIHtcbiAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUoZWxlbWVudC5odG1sKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50Lmh0bWwobmdNb2RlbC4kdmlld1ZhbHVlIHx8IFwiXCIpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZWxlbWVudC5iaW5kKFwiYmx1ciBrZXl1cCBjaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KHJlYWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG5hcHAuZmFjdG9yeSgnZXZlbnRCdXNTZXJ2aWNlJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcblxuICAgdmFyIG1zZ0J1cyA9IHt9O1xuXG4gICBtc2dCdXMucHVibGlzaCA9IGZ1bmN0aW9uKG1zZywgZGF0YSkge1xuICAgICAgIGRhdGEgPSBkYXRhIHx8IHt9O1xuICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdChtc2csIGRhdGEpO1xuICAgfTtcblxuICAgbXNnQnVzLnN1YnNjcmliZSA9IGZ1bmN0aW9uKG1zZywgc2NvcGUsIGZ1bmMpIHtcbiAgICAgICByZXR1cm4gc2NvcGUuJG9uKG1zZywgZnVuYyk7IC8vIHJldHVybiBmb3IgZGVzdHJveWluZyBsaXN0ZW5lclxuICAgfTtcblxuICAgcmV0dXJuIG1zZ0J1cztcblxufSk7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuYXBwLmZpbHRlcignY3VycmVuY3lOdW1iZXJGaWx0ZXInLCBbJyRsb2NhbGUnLCBmdW5jdGlvbiAoJGxvY2FsZSkge1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFtb3VudCwgZGl2aWRlcikge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChkaXZpZGVyKSkge1xuICAgICAgICAgICAgZGl2aWRlciA9ICcgJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhbW91bnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYW1vdW50KSB7XG4gICAgICAgICAgICB2YXIgcGFydHMgPSBhbW91bnQudG9GaXhlZCgyKS50b1N0cmluZygpLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICBwYXJ0c1swXSA9IHBhcnRzWzBdLnJlcGxhY2UoL1xcQig/PShcXGR7M30pKyg/IVxcZCkpL2csIGRpdmlkZXIpO1xuXG4gICAgICAgICAgICByZXR1cm4gcGFydHMuam9pbignLicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICcwLjAwJztcbiAgICAgICAgfVxuICAgIH07XG5cbn1dKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBFeGFtcGxlIG9mIHVzZTpcbiAqIDxpbnB1dCB0eXBlPVwiZW1haWxcIiBuYW1lPVwiZW1haWwyXCIgbmctbW9kZWw9XCJlbWFpbFJlZzJcIiBjdXN0b20tdmFsaWRhdG9yPVwiZW1haWxNYXRjaFwiIGRhdGEtdmFsaWRhdGUtZnVuY3Rpb249XCJjaGVja0VtYWlsTWF0Y2godmFsdWUpXCI+XG4gKiA8c3BhbiBuZy1zaG93PVwicmVnaXN0ZXJGb3JtLmVtYWlsMi4kZXJyb3IuZW1haWxNYXRjaFwiPkVtYWlscyBoYXZlIHRvIG1hdGNoITwvc3Bhbj5cbiAqXG4gKiBJbiBjb250cm9sbGVyOlxuICogJHNjb3BlLmNoZWNrRW1haWxNYXRjaD1mdW5jdGlvbih2YWx1ZSkge1xuICogICAgcmV0dXJuIHZhbHVlPT09JHNjb3BlLmVtYWlsUmVnO1xuICogfVxuICovXG5cbmFwcC5kaXJlY3RpdmUoJ2N1c3RvbVZhbGlkYXRvcicsIFtmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgdmFsaWRhdGVGdW5jdGlvbjogJyYnXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxtLCBhdHRyLCBuZ01vZGVsQ3RybCkge1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2NvcGUudmFsaWRhdGVGdW5jdGlvbih7ICd2YWx1ZSc6IHZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgfHwgcmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnRoZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7IC8vIEZvciBwcm9taXNlIHR5cGUgcmVzdWx0IG9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eShhdHRyLmN1c3RvbVZhbGlkYXRvciwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoYXR0ci5jdXN0b21WYWxpZGF0b3IsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KGF0dHIuY3VzdG9tVmFsaWRhdG9yLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCA/IHZhbHVlIDogdW5kZWZpbmVkOyAvLyBGb3IgYm9vbGVhbiByZXN1bHQgcmV0dXJuIGJhc2VkIG9uIGJvb2xlYW4gdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG5hcHAuZGlyZWN0aXZlKCdub0RpcnR5JywgZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4ge1xuXHRcdHJlcXVpcmU6ICduZ01vZGVsJyxcblx0XHRsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsQ3RybCkge1xuXHRcdFx0Ly8gb3ZlcnJpZGUgdGhlICRzZXREaXJ0eSBtZXRob2Qgb24gbmdNb2RlbENvbnRyb2xsZXJcblx0XHRcdG5nTW9kZWxDdHJsLiRzZXREaXJ0eSA9IGFuZ3VsYXIubm9vcDtcblx0XHR9XG5cdH1cbn0pOyJdfQ==
